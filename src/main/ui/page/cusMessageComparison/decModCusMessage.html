<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="/base.js"></script>
    <script type="module" src="/main.js"></script>
</head>
<body>
    <div id="main">
        <navigation></navigation>
        <div id="body">
            <div>
                <button @click="select()" style="width: 100%;" type="button" class="btn btn-primary">选择报文...</button>
            </div>
        </div>
    </div>
</body>
</html>

<script type="module">
    import cusMessageApi from "../../api/service/cusMessageApi.js";
    import alertComponent from "../../component/alertComponent.js";
    import loadingComponent from "../../component/loadingComponent.js";

    new Vue({
        el: "#main",

        data: {},

        methods: {
            select() {
                let fileInput = document.createElement("input");

                fileInput.setAttribute("type", "file");
                fileInput.addEventListener("change", function () {
                    loadingComponent.open();
                    cusMessageApi.decModCusMessageComparison({
                        decModCusMessage: fileInput.files[0]
                    }).then(function (message) {
                        alertComponent.popup(message.messages);
                    }).catch(function (message) {
                        alertComponent.popup(message);
                    }).finally(function () {
                        loadingComponent.close();
                    });
                });

                fileInput.click();
            }
        }
    });
</script>